<style>
    h1.title {
        position: absolute;
        z-index: 50;
        width: 1343px;
        height: 866px;
        top: 495px;
        left: 0;
        color: white;
    }
    #result-chart {
        display: block;
        width: 998px !important;
        height: 400px !important;
        position: absolute;
        top: 376px;
        left: 167px;
    }
</style>
<h1 class="title">{{name}}</h1>
<div id="voting"></div>
<canvas id="result-chart" width="200" height="200" style="width: 200px; height: 200px">

</canvas>
<script type="text/javascript" src="/plugin/cue/js/stages.js">
</script>
<script type="text/javascript" src="/plugin/cue/js/needle.js">
</script>
<script type="text/javascript" src="/plugin/cue/js/cue-view.js">
</script>
<script>



  

  function render() {
    
    var cues = [];
    {{#nextcues}}
    cues.push('{{id}}');
    {{/nextcues}}
    

    elements = [];
    var needle = new deus.needle.Needle(cues,
            {name: "no-music", repeat: false, fadeOut: true}, false
    );
    needle.rotate = false;
    needle.img = '/plugin/cue/sxsw/frostbank.png';
    needle.top = -150;
    //needle.jiggleX = true;
      {{#multiple}}
      needle.halflife = true;
      {{/multiple}}
    needle.socket.on('winner.display', function(cmd) {
        console.log(cmd);
        var data = {
            labels: ["Yes", "No"],
            datasets: [
                {
                    fillColor: 'rgba(133,75,79, .80)',
                    strokeColor: '#854B4F',
                    highlightFill: '#854B4F',
                    highlightStroke: '#854B4F',
                    data: [needle.oneVotes || 0, needle.twoVotes || 0]
                }
            ]
        };

        var resultChart = document.getElementById('result-chart');
        //resultChart.width = $(resultChart).width();
        //resultChart.height = $(resultChart).height();
        var myBarChart = new Chart(resultChart.getContext('2d')).Bar(data, {
            barValueSpacing : 400,
            tooltipTemplate: "<%= value %>",
            tooltipFillColor: "rgba(0,0,0,0)",
            tooltipFontColor: "#fff",
            tooltipFontFamily: 'BrandonPrinted-One',
            tooltipFontSize: 72,
            tooltipEvents: [],
            tooltipCaretSize: 0,
            onAnimationComplete: function()
            {
                this.showTooltip(this.datasets[0].bars, true);
            }
        });
        $('#cue-canvas').css('opacity', 0.2);
        $('h1.title').css('opacity', 0.2);
        $(resultChart).show();
    });



      elements.push(new deus.stage.DualStage());
    elements.push(needle);

    var i = 0;
    {{#voteoptions}}
        i++;
        var sprite = new deus.sprite.Sprite(needle, elements.length - 1, 2, '{{img}}', '{{snd}}')
        sprite.y = 650;
        if (i == 1) {
            sprite.x = 350;
        } else if(i == 2) {
            sprite.x = 850;
        }

        elements.push(sprite);
    {{/voteoptions}}
    var i;
    for(i = 0; i < elements.length; i++) {
      elements[i].add(stage);
    }
    
    
  }
  $.get("/e/{{shortname}}", function(response) {
    $('#voting').html(response);
    render();
  });
</script>
